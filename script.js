// Default templates configuration for both categories
const defaultTemplates = {
  soccerBlack: {
    1: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 41,
          yPercent: 51,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 64,
          right: 38,
          yPercent: 51,
          rotation: -5,
          fontSize: 12,
        },
      ],
    },
    2: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 42,
          yPercent: 51,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 63.5,
          right: 33.5,
          yPercent: 45.5,
          rotation: -10,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 63,
          right: 38,
          yPercent: 55,
          rotation: 6,
          fontSize: 12,
        },
      ],
    },
    3: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 42,
          yPercent: 51.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 60,
          right: 36,
          yPercent: 39.5,
          rotation: -25,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 63.5,
          right: 38,
          yPercent: 50,
          rotation: 0,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 60.5,
          right: 35.5,
          yPercent: 60.5,
          rotation: 25,
          fontSize: 12,
        },
      ],
    },
    4: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 42,
          yPercent: 51.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 55,
          right: 39.5,
          yPercent: 35,
          rotation: -48,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 63.5,
          right: 31,
          yPercent: 44.5,
          rotation: -14,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 63,
          right: 37,
          yPercent: 54,
          rotation: 5,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 56,
          right: 39.5,
          yPercent: 65,
          rotation: 38,
          fontSize: 12,
        },
      ],
    },
    5: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 42.5,
          yPercent: 51.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 50.5,
          right: 45,
          yPercent: 33.5,
          rotation: -73,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 61,
          right: 35.5,
          yPercent: 39.5,
          rotation: -41,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 63.5,
          right: 38,
          yPercent: 50,
          rotation: -1,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 59,
          right: 35.5,
          yPercent: 61,
          rotation: 36,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 50,
          right: 45.5,
          yPercent: 67,
          rotation: 68,
          fontSize: 12,
        },
      ],
    },
    6: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 42,
          yPercent: 51.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 45.5,
          right: 50,
          yPercent: 33.5,
          rotation: -87,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 57,
          right: 39.5,
          yPercent: 36.5,
          rotation: -58,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 63,
          right: 34,
          yPercent: 46,
          rotation: -18,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 62.5,
          right: 38,
          yPercent: 55,
          rotation: 6,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 56.5,
          right: 39,
          yPercent: 64,
          rotation: 44,
          fontSize: 12,
        },
        {
          id: "text7",
          content: "Alice",
          xPercent: 44.5,
          right: 52,
          yPercent: 66.5,
          rotation: 89,
          fontSize: 12,
        },
      ],
    },
  },
  soccer: {
    1: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 36,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 57,
          right: 38,
          yPercent: 51,
          rotation: -4,
          fontSize: 12,
        },
      ],
    },
    2: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 37,
          yPercent: 51.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noahhhhh",
          xPercent: 56.5,
          right: 38,
          yPercent: 46,
          rotation: -11,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 56,
          right: 38,
          yPercent: 55.5,
          rotation: 6,
          fontSize: 12,
        },
      ],
    },
    3: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 37,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 53.5,
          right: 42,
          yPercent: 40,
          rotation: -30,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 56.5,
          right: 38,
          yPercent: 50,
          rotation: -6,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 54,
          right: 42,
          yPercent: 61,
          rotation: 28,
          fontSize: 12,
        },
      ],
    },
    4: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 37,
          yPercent: 52,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 49,
          right: 46.5,
          yPercent: 35.5,
          rotation: -55,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 56.5,
          right: 39,
          yPercent: 45,
          rotation: -18,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 56,
          right: 38,
          yPercent: 54.5,
          rotation: 2,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 50,
          right: 45.5,
          yPercent: 65.5,
          rotation: 41,
          fontSize: 12,
        },
      ],
    },
    5: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 37,
          yPercent: 52,
          rotation: 1,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 44.5,
          right: 51,
          yPercent: 34,
          rotation: -77,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 54.5,
          right: 41.5,
          yPercent: 40,
          rotation: -45,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 56.5,
          right: 38,
          yPercent: 50.5,
          rotation: -1,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 52.5,
          right: 43,
          yPercent: 61,
          rotation: 37,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 44.5,
          right: 52,
          yPercent: 67,
          rotation: 70,
          fontSize: 12,
        },
      ],
    },
    6: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 37,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 40,
          right: 55.5,
          yPercent: 34,
          rotation: -90,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 51,
          right: 45.5,
          yPercent: 37.5,
          rotation: -58,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 56.5,
          right: 40,
          yPercent: 46.5,
          rotation: -20,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 56,
          right: 38,
          yPercent: 55.5,
          rotation: 6,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 50.5,
          right: 45.5,
          yPercent: 64.5,
          rotation: 46,
          fontSize: 12,
        },
        {
          id: "text7",
          content: "Alice",
          xPercent: 39,
          right: 57,
          yPercent: 67,
          rotation: 87,
          fontSize: 12,
        },
      ],
    },
  },
  soccerWhite: {
    1: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 37.5,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 59,
          right: 38,
          yPercent: 51,
          rotation: -5,
          fontSize: 12,
        },
      ],
    },
    2: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 39,
          yPercent: 52,
          rotation: 0,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 58.5,
          right: 38,
          yPercent: 46,
          rotation: -11,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 58,
          right: 38,
          yPercent: 55.5,
          rotation: 9,
          fontSize: 12,
        },
      ],
    },
    3: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 38.5,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 55.5,
          right: 39.5,
          yPercent: 40,
          rotation: -30,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 59,
          right: 37,
          yPercent: 50,
          rotation: -7,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 56,
          right: 40,
          yPercent: 61,
          rotation: 25,
          fontSize: 12,
        },
      ],
    },
    4: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 38,
          yPercent: 52,
          rotation: 0,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 51,
          right: 44.5,
          yPercent: 35.5,
          rotation: -53,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 58.5,
          right: 36.5,
          yPercent: 45,
          rotation: -16,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 58.5,
          right: 38,
          yPercent: 55,
          rotation: 5,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 52,
          right: 44,
          yPercent: 65.5,
          rotation: 43,
          fontSize: 12,
        },
      ],
    },
    5: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 39,
          yPercent: 52,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 46.5,
          right: 49,
          yPercent: 34.5,
          rotation: -75,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 56.5,
          right: 39.5,
          yPercent: 40,
          rotation: -40,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 58.5,
          right: 38,
          yPercent: 50.5,
          rotation: -2,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 54.5,
          right: 41.5,
          yPercent: 61,
          rotation: 38,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 46,
          right: 49.5,
          yPercent: 67,
          rotation: 72,
          fontSize: 12,
        },
      ],
    },
    6: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 39,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 42,
          right: 53.5,
          yPercent: 34,
          rotation: -91,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 53,
          right: 44,
          yPercent: 37.5,
          rotation: -60,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 58.5,
          right: 38,
          yPercent: 46.5,
          rotation: -20,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 57.5,
          right: 38,
          yPercent: 56,
          rotation: 9,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 52.5,
          right: 42.5,
          yPercent: 65,
          rotation: 43,
          fontSize: 12,
        },
        {
          id: "text7",
          content: "Alice",
          xPercent: 41,
          right: 55,
          yPercent: 67.5,
          rotation: 83,
          fontSize: 12,
        },
      ],
    },
  },
  toolsBlack: {
    1: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 41,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 64,
          right: 38,
          yPercent: 52,
          rotation: -5,
          fontSize: 12,
        },
      ],
    },
    2: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 41,
          yPercent: 51,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 62.5,
          right: 38,
          yPercent: 46,
          rotation: -10,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 62,
          right: 38,
          yPercent: 55,
          rotation: 6,
          fontSize: 12,
        },
      ],
    },
    3: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 41,
          yPercent: 52,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 59,
          right: 37.5,
          yPercent: 40.5,
          rotation: -28,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 62.5,
          right: 38,
          yPercent: 51,
          rotation: -7,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 59,
          right: 36,
          yPercent: 61.5,
          rotation: 26,
          fontSize: 12,
        },
      ],
    },
    4: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 41.5,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 54.5,
          right: 40.5,
          yPercent: 36.5,
          rotation: -48,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 63,
          right: 38,
          yPercent: 46,
          rotation: -16,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 62.5,
          right: 33.5,
          yPercent: 55.5,
          rotation: 6,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 55.5,
          right: 40,
          yPercent: 66,
          rotation: 44,
          fontSize: 12,
        },
      ],
    },
    5: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 42,
          yPercent: 52,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 50,
          right: 45.5,
          yPercent: 34.5,
          rotation: -71,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 60.5,
          right: 36,
          yPercent: 40.5,
          rotation: -41,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 63,
          right: 38,
          yPercent: 51,
          rotation: -1,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 58.5,
          right: 37,
          yPercent: 61.5,
          rotation: 39,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 49.5,
          right: 46,
          yPercent: 67.5,
          rotation: 70,
          fontSize: 12,
        },
      ],
    },
    6: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 41.5,
          yPercent: 52,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 45,
          right: 50.5,
          yPercent: 33.5,
          rotation: -90,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 56.5,
          right: 40,
          yPercent: 37.5,
          rotation: -58,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 63,
          right: 33,
          yPercent: 46,
          rotation: -21,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 62,
          right: 34.5,
          yPercent: 55.5,
          rotation: 6,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 56,
          right: 40,
          yPercent: 64,
          rotation: 47,
          fontSize: 12,
        },
        {
          id: "text7",
          content: "Alice",
          xPercent: 44,
          right: 52,
          yPercent: 67,
          rotation: 89,
          fontSize: 12,
        },
      ],
    },
  },
  tools: {
    1: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 36,
          yPercent: 53.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 57,
          right: 38,
          yPercent: 52,
          rotation: -4,
          fontSize: 12,
        },
      ],
    },
    2: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 36,
          yPercent: 51.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 56,
          right: 38,
          yPercent: 46,
          rotation: -11,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 55.5,
          right: 38,
          yPercent: 55.5,
          rotation: 6,
          fontSize: 12,
        },
      ],
    },
    3: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 35.5,
          yPercent: 53,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 52.5,
          right: 43,
          yPercent: 41,
          rotation: -29,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 56,
          right: 38,
          yPercent: 51,
          rotation: -7,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 53,
          right: 42.5,
          yPercent: 62,
          rotation: 25,
          fontSize: 12,
        },
      ],
    },
    4: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 36.5,
          yPercent: 53,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 48.5,
          right: 47,
          yPercent: 37,
          rotation: -52,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 56.5,
          right: 38,
          yPercent: 46,
          rotation: -17,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 56,
          right: 38,
          yPercent: 56,
          rotation: 5,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 49.5,
          right: 46.5,
          yPercent: 66,
          rotation: 43,
          fontSize: 12,
        },
      ],
    },
    5: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 36.5,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 44,
          right: 52,
          yPercent: 35.5,
          rotation: -77,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 54,
          right: 42,
          yPercent: 41,
          rotation: -45,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 56,
          right: 38,
          yPercent: 51.5,
          rotation: -1,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 52.5,
          right: 42.5,
          yPercent: 62,
          rotation: 36,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 44,
          right: 52,
          yPercent: 68,
          rotation: 67,
          fontSize: 12,
        },
      ],
    },
    6: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 36.5,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 39.5,
          right: 56,
          yPercent: 34,
          rotation: -90,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 50.5,
          right: 46,
          yPercent: 38,
          rotation: -58,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 56,
          right: 41,
          yPercent: 47,
          rotation: -19,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 55.5,
          right: 38,
          yPercent: 56,
          rotation: 6,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 50,
          right: 45,
          yPercent: 65,
          rotation: 46,
          fontSize: 12,
        },
        {
          id: "text7",
          content: "Alice",
          xPercent: 38.5,
          right: 57,
          yPercent: 67.5,
          rotation: 89,
          fontSize: 12,
        },
      ],
    },
  },
  toolsWhite: {
    1: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 38,
          yPercent: 53.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 59.5,
          right: 38,
          yPercent: 52,
          rotation: -5,
          fontSize: 12,
        },
      ],
    },
    2: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 37.5,
          yPercent: 51.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 58,
          right: 38,
          yPercent: 46,
          rotation: -11,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 57.5,
          right: 38,
          yPercent: 55.5,
          rotation: 5,
          fontSize: 12,
        },
      ],
    },
    3: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 37.5,
          yPercent: 53,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 55,
          right: 41,
          yPercent: 41,
          rotation: -30,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 57.5,
          right: 38,
          yPercent: 51.5,
          rotation: -7,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 55,
          right: 40.5,
          yPercent: 62,
          rotation: 25,
          fontSize: 12,
        },
      ],
    },
    4: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 38,
          yPercent: 53,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 50.5,
          right: 45,
          yPercent: 37,
          rotation: -53,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 58,
          right: 38,
          yPercent: 46.5,
          rotation: -16,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 58,
          right: 38,
          yPercent: 56,
          rotation: 5,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 51.5,
          right: 44,
          yPercent: 66.5,
          rotation: 43,
          fontSize: 12,
        },
      ],
    },
    5: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 38.5,
          yPercent: 53,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 46,
          right: 49.5,
          yPercent: 35.5,
          rotation: -75,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 56,
          right: 40,
          yPercent: 41,
          rotation: -40,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 58,
          right: 38,
          yPercent: 51.5,
          rotation: 0,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 54,
          right: 41,
          yPercent: 62,
          rotation: 38,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 46,
          right: 50.5,
          yPercent: 68,
          rotation: 71,
          fontSize: 12,
        },
      ],
    },
    6: {
      textFields: [
        {
          id: "text1",
          content: "TRANARE",
          xPercent: 38.5,
          yPercent: 52.5,
          rotation: 2,
          fontSize: 16,
        },
        {
          id: "text2",
          content: "Noah",
          xPercent: 41.5,
          right: 54,
          yPercent: 34.5,
          rotation: -91,
          fontSize: 12,
        },
        {
          id: "text3",
          content: "Vera",
          xPercent: 52.5,
          right: 43.5,
          yPercent: 37.5,
          rotation: -60,
          fontSize: 12,
        },
        {
          id: "text4",
          content: "Hugo",
          xPercent: 58,
          right: 38,
          yPercent: 47,
          rotation: -20,
          fontSize: 12,
        },
        {
          id: "text5",
          content: "Alma",
          xPercent: 57.5,
          right: 38,
          yPercent: 56,
          rotation: 9,
          fontSize: 12,
        },
        {
          id: "text6",
          content: "Liam",
          xPercent: 52,
          right: 43.5,
          yPercent: 65,
          rotation: 45,
          fontSize: 12,
        },
        {
          id: "text7",
          content: "Alice",
          xPercent: 41,
          right: 55.5,
          yPercent: 67.5,
          rotation: 86,
          fontSize: 12,
        },
      ],
    },
  },
};

// Current state
let originalFieldValues = {};
let currentCategory = "soccer";
let currentKids = 1;
let currentColor = "Black";
let currentTemplates = JSON.parse(
  JSON.stringify(defaultTemplates["soccerBlack"])
);
let textOverlays = {};
let selectedOverlay = null;
let isDragging = false;
let dragStartPos = { x: 0, y: 0 };

const deltaX = 50;
const MAX_PERSONALIZATION_CHARS = 10; // Maximum character limit for personalization

// DOM elements
const baseImage = document.getElementById("baseImage");
const skeleton = document.getElementById("imageSkeleton");
const imageContainer = document.getElementById("imageContainer");
const textControlsContainer = document.getElementById("text-controls");
const exportBtn = document.getElementById("exportBtn");

// Initialize the application
function init() {
  setupEventListeners();
  updateImageSource();
}

function setupEventListeners() {
  // Category selection
  document.querySelectorAll(".category-variant").forEach((variant) => {
    variant.addEventListener("click", handleCategoryChange);
  });

  // Kids selection
  document.querySelectorAll('input[name="kids"]').forEach((radio) => {
    radio.addEventListener("change", handleKidsChange);
  });

  // Color variants
  document.querySelectorAll(".color-variant").forEach((variant) => {
    variant.addEventListener("click", handleColorChange);
  });

  // Export
  exportBtn.addEventListener("click", exportTemplate);

  // Image container mouse events for dragging
  imageContainer.addEventListener("mousedown", handleMouseDown);
  document.addEventListener("mousemove", handleMouseMove);
  document.addEventListener("mouseup", handleMouseUp);
}

function storeOriginalValues() {
  const template = currentTemplates[currentKids];
  originalFieldValues[currentKids] = {};

  template.textFields.forEach((field) => {
    originalFieldValues[currentKids][field.id] = {
      xPercent: field.xPercent,
      yPercent: field.yPercent,
      right: field.right,
      rotation: field.rotation,
      fontSize: field.fontSize,
    };
  });
}

function handleCategoryChange(e) {
  // Update selected style
  document.querySelectorAll(".category-variant").forEach((variant) => {
    variant.classList.remove("selected");
  });
  e.target.classList.add("selected");
  currentCategory = e.target.dataset.category;
  const colorVariant = document.querySelector(".color-variants");

  colorVariant.style.display = "flex";

  const templateKey =
    currentColor === "White"
      ? `${currentCategory}White`
      : currentColor === "Black"
      ? `${currentCategory}Black`
      : currentCategory;
  currentTemplates = JSON.parse(JSON.stringify(defaultTemplates[templateKey]));

  updateImageSource();
}

function handleKidsChange(e) {
  // Update selected style
  document.querySelectorAll(".kids-options .option-item").forEach((item) => {
    item.classList.remove("selected");
  });
  e.target.parentElement.classList.add("selected");

  currentKids = parseInt(e.target.value);
  updateImageSource();
}

function handleColorChange(e) {
  // Update selected style
  document.querySelectorAll(".color-variant").forEach((variant) => {
    variant.classList.remove("selected");
  });
  e.target.classList.add("selected");

  currentColor = e.target.dataset.color;
  const templateKey =
    currentColor === "White"
      ? `${currentCategory}White`
      : currentColor === "Black"
      ? `${currentCategory}Black`
      : currentCategory;
  currentTemplates = JSON.parse(JSON.stringify(defaultTemplates[templateKey]));

  updateImageSource();
}

function updateImageSource() {
  clearOverlays();

  baseImage.style.display = "none";

  // Show loader and hide image
  skeleton.style.display = "block";

  // Construct new image URL (now inside assets folder)
  let imageUrl;
  imageUrl = `assets/${currentCategory}-preview-files/${currentColor}/${currentKids} Kid${
    currentKids > 1 ? "s" : ""
  } ${currentColor} Mug.jpeg`;

  // Set image source
  baseImage.src = imageUrl;

  // Wait for it to fully load
  baseImage.onload = function () {
    // Hide loader and show image
    skeleton.style.display = "none";
    baseImage.style.display = "block";

    updateTemplate();
  };
}

function updateTemplate() {
  clearOverlays();
  createTextControls();
  createTextOverlays();
  storeOriginalValues();
}

function clearOverlays() {
  document.querySelectorAll(".text-overlay").forEach((overlay) => {
    overlay.remove();
  });
  textOverlays = {};
  selectedOverlay = null;
}

function createTextControls() {
  textControlsContainer.innerHTML = "";

  const template = currentTemplates[currentKids];

  template.textFields.forEach((field, index) => {
    const controlGroup = document.createElement("div");
    controlGroup.className = "text-input-group";
    controlGroup.dataset.fieldId = field.id;

    const xControl = `
        <div class="control-row">
          <span class="control-label">X: ${field.xPercent}%</span>
          <div class="control-buttons">
            <button class="control-btn" onclick="adjustField('${field.id}', 'xPercent', -0.5)">-</button>
            <button class="control-btn" onclick="adjustField('${field.id}', 'xPercent', 0.5)">+</button>
          </div>
        </div>
      `;

    controlGroup.innerHTML = `
      <div class="form-group">
        <label>${field.id === "text1" ? "Dad/Mom" : `Child ${index}`}</label>
        <input type="text" value="${
          field.content || ""
        }" onchange="updateFieldContent('${field.id}', this.value)">
      </div>
      <div class="control-group">
        ${xControl}
        <div class="control-row">
          <span class="control-label">Y: ${field.yPercent}%</span>
          <div class="control-buttons">
            <button class="control-btn" onclick="adjustField('${
              field.id
            }', 'yPercent', -0.5)">-</button>
            <button class="control-btn" onclick="adjustField('${
              field.id
            }', 'yPercent', 0.5)">+</button>
          </div>
        </div>
        ${
          field.id === "text1"
            ? ""
            : `<div class="control-row">
              <span class="control-label">Right: ${field.right}%</span>
              <div class="control-buttons">
                <button
                  class="control-btn"
                  onclick="adjustField('${field.id}', 'right', -0.5)"
                >
                  -
                </button>
                <button
                  class="control-btn"
                  onclick="adjustField('${field.id}', 'right', 0.5)"
                >
                  +
                </button>
              </div>
            </div>`
        }
        <div class="control-row">
          <span class="control-label">Rotation: ${field.rotation}°</span>
          <div class="control-buttons">
            <button class="control-btn" onclick="adjustField('${
              field.id
            }', 'rotation', -1)">-</button>
            <button class="control-btn" onclick="adjustField('${
              field.id
            }', 'rotation', 1)">+</button>
          </div>
        </div>
        <div class="control-row">
          <span class="control-label">Size: ${field.fontSize}px</span>
          <div class="control-buttons">
            <button class="control-btn" onclick="adjustField('${
              field.id
            }', 'fontSize', -1)">-</button>
            <button class="control-btn" onclick="adjustField('${
              field.id
            }', 'fontSize', 1)">+</button>
          </div>
        </div>
      </div>
    `;

    textControlsContainer.appendChild(controlGroup);
  });
}

function createTextOverlays() {
  const template = currentTemplates[currentKids];
  const imageWrapper = document.querySelector(".image-wrapper");

  template.textFields.forEach((field) => {
    // Single overlay for categories (no printFile)
    const overlay = createOverlay(field);
    imageWrapper.appendChild(overlay);
    textOverlays[field.id] = overlay;
  });
}

function createOverlay(field) {
  const overlay = document.createElement("div");
  overlay.className = "text-overlay";
  overlay.dataset.fieldId = `overlay-${field.id}`;
  overlay.textContent = field.content || "";

  // Set position and rotation - note that transform-origin should be "left center" in CSS
  overlay.style.left = `${field.xPercent}%`;
  overlay.style.top = `${field.yPercent}%`;
  overlay.style.right = `${field.right}%`;
  overlay.style.transform =
    field.id === "text1"
      ? `translate(-100%, -50%) rotate(${field.rotation}deg)`
      : `translate(0, -50%) rotate(${field.rotation}deg)`;
  overlay.style.fontSize = `${field.fontSize}px`;

  // Ensure consistent vertical alignment
  overlay.style.lineHeight = "1";
  overlay.style.display = "inline-block";
  overlay.style.verticalAlign = "middle";

  // Apply dynamic font sizing based on text length
  adjustFontSize(overlay, field.fontSize);

  overlay.addEventListener("click", () => selectOverlay(overlay));

  return overlay;
}

// Font adjustment function similar to backend logic
function adjustFontSize(overlay, baseFontSize) {
  const charCount = overlay.textContent.trim().length;
  const maxChars = MAX_PERSONALIZATION_CHARS; // 10 characters

  // Check if device is mobile
  const isMobile = window.innerWidth <= 768;

  // Different scaling factors for mobile and desktop
  const minScaleFactor = isMobile ? 0.4 : 0.6;

  // Linearly scale down from 100% to minScaleFactor as char count goes from 1 to maxChars
  const scaleFactor =
    1 - ((charCount - 1) / (maxChars - 1)) * (1 - minScaleFactor);
  const adjustedFontSize = baseFontSize * scaleFactor;

  // Ensure the font size doesn't go below the minimum scale
  overlay.style.fontSize = `${Math.max(
    adjustedFontSize,
    baseFontSize * minScaleFactor
  )}px`;
}

function selectOverlay(overlay) {
  // Remove previous selection
  document.querySelectorAll(".text-overlay").forEach((o) => {
    o.classList.remove("selected");
  });
  document.querySelectorAll(".text-input-group").forEach((g) => {
    g.classList.remove("active");
  });

  // Select new overlay only if overlay is not null
  if (overlay) {
    const fieldId = overlay.dataset.fieldId.split("-")[1]; // Get base fieldId (e.g., text1)
    overlay.classList.add("selected");
    selectedOverlay = overlay;

    // Highlight corresponding control group
    const controlGroup = document.querySelector(
      `[data-field-id="overlay-${fieldId}"]`
    );
    if (controlGroup) {
      controlGroup.classList.add("active");
    }
  } else {
    selectedOverlay = null;
  }
}

function updateFieldContent(fieldId, newContent) {
  const template = currentTemplates[currentKids];
  const field = template.textFields.find((f) => f.id === fieldId);
  if (field) {
    field.content = newContent;
    const overlay = textOverlays[fieldId];
    if (overlay) {
      overlay.textContent = newContent;
      // Reapply font size adjustment when content changes
      adjustFontSize(overlay, field.fontSize);
    }
  }
}

function adjustField(fieldId, property, delta) {
  const template = currentTemplates[currentKids];
  const field = template.textFields.find((f) => f.id === fieldId);

  if (!field) return;

  // Get original values
  const originalValues = originalFieldValues[currentKids]?.[fieldId];
  if (!originalValues) return;

  // Apply adjustment
  let newValue = field[property] + delta;

  // Set bounds based on property with limits from original values
  switch (property) {
    case "xPercent":
      const originalPos = originalValues.xPercent;
      const minPos = Math.max(0, originalPos - 15);
      const maxPos = Math.min(100, originalPos + 15);
      newValue = Math.max(minPos, Math.min(maxPos, newValue));
      break;
    case "yPercent":
      const originalY = originalValues.yPercent;
      const minY = Math.max(0, originalY - 15);
      const maxY = Math.min(100, originalY + 15);
      newValue = Math.max(minY, Math.min(maxY, newValue));
      break;
    case "right":
      const originalRight = originalValues.right;
      const minRight = Math.max(0, originalRight - 25);
      const maxRight = Math.min(100, originalRight + 25);
      newValue = Math.max(minRight, Math.min(maxRight, newValue));
      break;
    case "rotation":
      const originalRot = originalValues.rotation;
      const minRot = originalRot - 50;
      const maxRot = originalRot + 50;
      newValue = Math.max(minRot, Math.min(maxRot, newValue));
      break;
    case "fontSize":
      const originalSize = originalValues.fontSize;
      const minSize = Math.max(8, originalSize - 5);
      const maxSize = Math.min(72, originalSize + 5);
      newValue = Math.max(minSize, Math.min(maxSize, newValue));
      break;
  }

  field[property] = newValue;

  // Update overlay
  updateOverlayStyle(fieldId);

  // Update control labels
  updateControlLabels(fieldId);
}

function updateOverlayStyle(fieldId) {
  const template = currentTemplates[currentKids];
  const field = template.textFields.find((f) => f.id === fieldId);

  if (!field) return;

  const overlay = textOverlays[fieldId];
  if (overlay) {
    overlay.style.left = `${field.xPercent}%`;
    overlay.style.top = `${field.yPercent}%`;
    overlay.style.right = `${field.right}%`;
    overlay.style.transform =
      field.id === "text1"
        ? `translate(-100%, -50%) rotate(${field.rotation}deg)`
        : `translate(0, -50%) rotate(${field.rotation}deg)`;

    // Update font size and apply dynamic sizing
    overlay.style.fontSize = `${field.fontSize}px`;
    adjustFontSize(overlay, field.fontSize);
  }
}

function updateControlLabels(fieldId) {
  const template = currentTemplates[currentKids];
  template.textFields.forEach((field) => {
    if (field.id !== fieldId) return;

    const controlGroup = document.querySelector(
      `.text-input-group[data-field-id="${field.id}"]`
    );

    if (!controlGroup) return;

    const labels = controlGroup.querySelectorAll(".control-label");

    if (labels.length >= 5) {
      labels[0].textContent = `X: ${field.xPercent}%`;
      labels[1].textContent = `Y: ${field.yPercent}%`;
      labels[2].textContent = `Right: ${field.right}%`;
      labels[3].textContent = `Rotation: ${field.rotation}°`;
      labels[4].textContent = `Size: ${field.fontSize}px`;
    }
  });
}

// Mouse event handlers for dragging
function handleMouseDown(e) {
  const overlay = e.target.closest(".text-overlay");
  if (!overlay) return;

  e.preventDefault();
  isDragging = true;
  selectedOverlay = overlay;

  overlay.classList.add("dragging");
  selectOverlay(overlay);

  const rect = imageContainer.getBoundingClientRect();
  dragStartPos = {
    x: e.clientX - rect.left,
    y: e.clientY - rect.top,
  };
}

function handleMouseMove(e) {
  if (!isDragging || !selectedOverlay) return;

  e.preventDefault();

  const rect = imageContainer.getBoundingClientRect();
  const imageRect = baseImage.getBoundingClientRect();

  // Calculate position relative to the image
  const x = e.clientX - imageRect.left;
  const y = e.clientY - imageRect.top;

  let xPercent = Math.max(0, Math.min(100, (x / imageRect.width) * 100));
  let yPercent = Math.max(0, Math.min(100, (y / imageRect.height) * 100));

  // Get field ID and original values
  const fieldId = selectedOverlay.dataset.fieldId.split("-")[1];
  const originalValues = originalFieldValues[currentKids]?.[fieldId];
  const template = currentTemplates[currentKids];
  const field = template.textFields.find((f) => f.id === fieldId);

  if (originalValues) {
    // Apply position bounds (+/-15% from original)
    const minX = Math.max(0, originalValues.xPercent - 15);
    const maxX = Math.min(100, originalValues.xPercent + 15);
    const minY = Math.max(0, originalValues.yPercent - 15);
    const maxY = Math.min(100, originalValues.yPercent + 15);

    xPercent = Math.max(minX, Math.min(maxX, xPercent));
    yPercent = Math.max(minY, Math.min(maxY, yPercent));
  }

  // Update overlay position with left alignment
  selectedOverlay.style.left = `${xPercent}%`;
  selectedOverlay.style.top = `${yPercent}%`;

  // Update template data
  if (field) {
    field.xPercent = Math.round(xPercent);
    field.yPercent = Math.round(yPercent);
  }
}

function handleMouseUp(e) {
  if (isDragging && selectedOverlay) {
    selectedOverlay.classList.remove("dragging");
    const fieldId = selectedOverlay.dataset.fieldId.split("-")[1];
    updateControlLabels(fieldId);
  }

  isDragging = false;
  selectedOverlay = null;
  selectOverlay(null);
}

function exportTemplate() {
  const exportData = {
    category: currentCategory,
    templates: currentTemplates,
    color: currentColor,
    imageSize: {
      width: baseImage.naturalWidth,
      height: baseImage.naturalHeight,
    },
    metadata: {
      exportDate: new Date().toISOString(),
      version: "1.0",
      publisher: "10daer",
    },
  };

  const dataStr = JSON.stringify(exportData, null, 2);
  const dataBlob = new Blob([dataStr], { type: "application/json" });

  // Save to assets/template folder
  const fileName = `${currentCategory}-${currentColor}-template-config-${Date.now()}.json`;
  const filePath = `assets/template/${fileName}`;

  // For browsers, we can't write directly to disk, so we just set the download path as a suggestion
  const link = document.createElement("a");
  link.href = URL.createObjectURL(dataBlob);
  link.download = filePath;
  link.click();

  URL.revokeObjectURL(link.href);
}

// Make functions globally available
window.updateFieldContent = updateFieldContent;
window.adjustField = adjustField;

// Initialize the application when DOM is loaded
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", init);
} else {
  init();
}
